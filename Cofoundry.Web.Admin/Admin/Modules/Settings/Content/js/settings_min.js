angular.module("cms.settings",["ngRoute","cms.shared"]).constant("_",window._).constant("settings.modulePath","/Admin/Modules/Settings/Js/");
angular.module("cms.settings").config(["$routeProvider","shared.routingUtilities","settings.modulePath",function(t,i,e){t.otherwise(i.mapOptions(e,"SettingsDetails"))}]);
angular.module("cms.settings").factory("settings.settingsService",["$http","shared.serviceBase",function(t,n){var e={},r=n+"settings",i=r+"/generalsite",s=r+"/seo";return e.getGeneralSiteSettings=function(){return t.get(i)},e.getSeoSettings=function(){return t.get(s)},e.updateGeneralSiteSettings=function(e){return t.patch(i,e)},e.updateSeoSettings=function(e){return t.patch(s,e)},e.clearCache=function(e){return t.delete(n+"cache")},e}]);
angular.module("cms.settings").controller("SettingsDetailsController",["_","$q","shared.LoadState","shared.permissionValidationService","settings.settingsService","settings.modulePath",function(t,a,e,n,o,i){var l=this;function s(){l.editMode=!0,l.mainForm.formStatus.clear()}function d(){var e;e=l.saveLoadState,l.globalLoadState.on(),e&&t.isFunction(e.on)&&e.on(),o.updateGeneralSiteSettings(l.generalSettingsCommand).then(o.updateSeoSettings.bind(null,l.seoSettingsCommand)).then(c.bind(null,"Changes were saved successfully")).finally(f.bind(null,l.saveLoadState))}function r(){l.editMode=!1,g(),l.mainForm.formStatus.clear()}function S(){l.globalLoadState.on(),o.clearCache().then(c.bind(null,"Cache cleared")).finally(l.globalLoadState.off)}function c(e){return u().then(l.mainForm.formStatus.success.bind(null,e))}function u(){var e=o.getGeneralSiteSettings().then(n.bind(null,"generalSettings")),t=o.getSeoSettings().then(n.bind(null,"seoSettings"));return a.all([e,t]).then(function(){g(),l.editMode=!1});function n(e,t){l[e]=t}}function g(){l.seoSettingsCommand=t.clone(l.seoSettings),l.generalSettingsCommand=t.clone(l.generalSettings)}function f(e){l.globalLoadState.off(),e&&t.isFunction(e.off)&&e.off()}l.edit=s,l.save=d,l.cancel=r,l.clearCache=S,l.editMode=!1,l.globalLoadState=new e,l.saveLoadState=new e,l.formLoadState=new e(!0),l.canUpdateSettings=n.hasPermission("COFSETGENUPD"),u().then(f.bind(null,l.formLoadState))}]);