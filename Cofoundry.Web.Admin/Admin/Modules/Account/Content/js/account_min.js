angular.module("cms.account",["ngRoute","cms.shared"]).constant("_",window._).constant("account.modulePath","/Admin/Modules/Account/Js/");
angular.module("cms.account").config(["$routeProvider","shared.routingUtilities","account.modulePath",function(o,a,n){o.when("/change-password",a.mapOptions(n,"ChangePassword")).otherwise(a.mapOptions(n,"AccountDetails"))}]);
angular.module("cms.account").factory("account.accountService",["$http","shared.serviceBase",function(c,t){var n={},u=t+"account";return n.getAccountDetails=function(){return c.get(u)},n.update=function(t){return c.patch(u,t)},n.updatePassword=function(t){return c.put(u+"/password",t)},n}]);
angular.module("cms.account").controller("AccountDetailsController",["shared.LoadState","shared.modalDialogService","shared.permissionValidationService","account.accountService","account.modulePath",function(n,a,e,t,o){var c=this;function i(){c.editMode=!0,c.mainForm.formStatus.clear()}function d(){s(c.saveLoadState),t.update(c.command).then(function(n){return l().then(c.mainForm.formStatus.success.bind(null,n))}.bind(null,"Changes were saved successfully")).finally(m.bind(null,c.saveLoadState))}function u(){c.editMode=!1,c.command=r(c.user),c.mainForm.formStatus.clear()}function l(){return t.getAccountDetails().then(function(n){c.user=n,c.command=r(n),c.editMode=!1})}function r(n){return _.pick(n,"displayName","email")}function s(n){c.globalLoadState.on(),n&&_.isFunction(n.on)&&n.on()}function m(n){c.globalLoadState.off(),n&&_.isFunction(n.off)&&n.off()}c.edit=i,c.save=d,c.cancel=u,c.editMode=!1,c.globalLoadState=new n,c.saveLoadState=new n,c.formLoadState=new n(!0),c.canUpdate=e.canUpdate("COFCUR"),l().then(m.bind(null,c.formLoadState))}]);
angular.module("cms.account").controller("ChangePasswordController",["$location","shared.LoadState","shared.userAreaService","account.accountService",function(o,a,n,t){var e=this;function c(){e.globalLoadState.on(),t.updatePassword(e.command).then(s).finally(e.globalLoadState.off)}function r(){s()}function d(o){return!!e.command&&e.command.newPassword===o}function s(){o.path("/")}e.save=c,e.cancel=r,e.doesPasswordMatch=d,e.globalLoadState=new a,e.formLoadState=new a(!0),n.getPasswordPolicy("COF").then(function(o){e.passwordPolicy=o}),t.getAccountDetails().then(function(o){e.user=o,e.command={}}).then(e.formLoadState.off)}]);